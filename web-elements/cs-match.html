<!doctype html>
<html>
	<template>
	<style>
	div.container
	{
		display: block;
		margin: 20px;
		background-color: #161616;
	}
	
	span.teamname
	{
		texsize: 2.7rem;
		color: #FFFFFF;
		font-weight: bold;
	}
	
	img
	{
		vertical-align: middle;
		width: 30px;
		padding: 0px 10px 0px 10px;
	}
	
	#result
	{
		font-size: 2.8rem;
		font-weight: bold;
	}
	</style>
	<div class="container">
		<span class="teamname">{{team1}}</span>
		<img src="{{icon1}}"/>
		<span id="result">{{result}}</span>
		<img src="{{icon2}}"/>
		<span class="teamname">{{team2}}</span>
	</div>
	</template>
	
	<script>
		var CsMatch = Object.create(HTMLElement.prototype);
		var CsMatchTemplate = document.currentScript.ownerDocument.getElementsByTagName("TEMPLATE")[0].innerHTML;
		var getTeamData = function(shortname) {
			return {
				"url" : window.location.href + "imgs/teams/" + shortname + ".cfg",
				"icon" : "./imgs/teams/" + shortname + ".png"
			};
		}
		CsMatch.createdCallback = function() {
			var shadow = this.createShadowRoot();
			var team1 = getTeamData(this.getAttribute("team1"));
			var team2 = getTeamData(this.getAttribute("team2"));
			var t = CsMatchTemplate;
			
			// Get Team 1 Full Name
			var request1 = new XMLHttpRequest();
			request1.open("GET", team1["url"], true);
			request1.responseType = "text";
			request1.onload = function() {
				console.log("Response recieved. Status = " + this.status);
				shadow.innerHTML = element.innerHTML.replace("{{team1}}", this.responseText);
			};
			request1.send();
			
			// Get Team 2 Full Name
			var request2 = new XMLHttpRequest();
			request2.open("GET", team2["url"], true);
			request2.responseType = "text";
			request2.onload = function() {
				console.log("Response recieved. Status = " + this.status);
				shadow.innerHTML = element.innerHTML.replace("{{team2}}", this.responseText);
			};
			request2.send();
			t = t.replace("{{icon1}}", team1["icon"]);
			t = t.replace("{{icon2}}", team2["icon"]);
			t = t.replace("{{result}}", this.innerText);
			shadow.innerHTML = t;
		}
		document.registerElement("cs-match", { prototype : CsMatch });
	</script>
	<!--
	<script>
		var CsMatch = Object.create(HTMLElement.prototype);
		var CsMatchTemplate = document.currentScript.ownerDocument.getElementsByTagName("TEMPLATE")[0].innerHTML;
		
		var getTeamData = function(shortname) {
			var request = new XMLHttpRequest();
			request.open("GET", window.location.href + "imgs/teams/" + shortname + ".cfg", true);
			request.send(null);
			console.log("Loaded team data: " + request.responseText);
			return {
				"fullname" : request.responseText,
				"logo" : "./imgs/teams/" + shortname + ".png"
			};
		};
		
		CsMatch.createdCallback = function() {
			var shadow = this.createShadowRoot();
			var team1 = getTeamData(this.getAttribute("team1"));
			var team2 = getTeamData(this.getAttribute("team2"));
			CsMatchTemplate = CsMatchTemplate.replace("{{team1}}", team1["fullname"]);
			CsMatchTemplate = CsMatchTemplate.replace("{{icon1}}", team1["logo"]);
			CsMatchTemplate = CsMatchTemplate.replace("{{team2}}", team2["fullname"]);
			CsMatchTemplate = CsMatchTemplate.replace("{{icon2}}", team2["logo"]);
			CsMatchTemplate = CsMatchTemplate.replace("{{result}}", this.innerText);
			shadow.innerHTML = CsMatchTemplate;
		};
		
		document.registerElement("cs-match", { prototype : CsMatch });
	</script>
	-->
</html>
